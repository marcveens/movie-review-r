dtm.train <- dtm[1:ceiling(df_count / 2),]
dtm.test <- dtm[(ceiling(df_count / 2) + 1):df_count,]
corpus.clean.train <- corpus.clean[1:ceiling(df_count / 2)]
corpus.clean.test <- corpus.clean[(ceiling(df_count / 2) + 1):df_count]
dim(dtm.train)
## Custom test set
# doc_id <- c(10000,10001,10002,10003,10004,10005,10006)
# text <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
# sentiment <- c(1, 0, 1, 1, 0, 1, 1)
# sentiment <- as.factor(sentiment)
# df.test <- data.frame(doc_id, text, sentiment)
# test_corpus <- Corpus(VectorSource(df.test$text))
# test_corpus.clean <- test_corpus %>%
#   tm_map(content_transformer(tolower)) %>%
#   tm_map(removePunctuation) %>%
#   tm_map(removeNumbers) %>%
#   tm_map(removeWords, stopwords(kind="en")) %>%
#   tm_map(stripWhitespace)
# dtm.test <- DocumentTermMatrix(test_corpus.clean)
# corpus.clean.test <- test_corpus.clean[]
fivefreq <- findFreqTerms(dtm.train, 5)
length((fivefreq))
## [1] 12144
# Use only 5 most frequent words (fivefreq) to build the DTM
dtm.train.nb <- DocumentTermMatrix(corpus.clean.train, control=list(dictionary = fivefreq))
dim(dtm.train.nb)
## [1]  1500 12144
dtm.test.nb <- DocumentTermMatrix(corpus.clean.test, control=list(dictionary = fivefreq))
dim(dtm.train.nb)
convert_count <- function(x) {
y <- ifelse(x > 0, 1,0)
y <- factor(y, levels=c(0,1), labels=c("No", "Yes"))
y
}
trainNB <- apply(dtm.train.nb, 2, convert_count)
testNB <- apply(dtm.test.nb, 2, convert_count)
classifier <- naiveBayes(trainNB, df.train$sentiment, laplace = 1)
pred <- predict(classifier, newdata=testNB)
table("Predictions"= pred,  "Actual" = df.test$sentiment )
conf.mat <- confusionMatrix(pred, df.test$sentiment)
conf.mat
custom_reviews <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_dtm <- apply(dtm.test.nb, 2, convert_count)
View(custom_dtm)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
table("pred"=custom_pred)
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
table("pred"=custom_pred)
View(custom_dtm)
View(custom_dtm)
library(tm)
library(RTextTools)
library(e1071)
library(dplyr)
library(caret)
library(mongolite)
## Get all data from Mongo
con=mongo(collection="reviews",db="movies")
df <-con$find("{}")
df_count <- nrow(df)
View(df)
set.seed(1)
## Clean the corpus
clean_corpus <- function(corpus) {
corpus %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(removeWords, stopwords(kind="en")) %>%
tm_map(stripWhitespace)
}
## Randomize all results
df <- df[sample(nrow(df)), ]
df$sentiment <- as.factor(df$sentiment)
corpus <- Corpus(VectorSource(df$text))
corpus.clean <- clean_corpus(corpus)
dtm <- DocumentTermMatrix(corpus.clean)
## Used for the statistics later on
df.train <- df[1:ceiling(df_count / 2),]
dtm.train <- dtm[1:ceiling(df_count / 2),]
corpus.clean.train <- corpus.clean[1:ceiling(df_count / 2)]
fivefreq <- findFreqTerms(dtm.train, 5)
dtm.train.nb <- DocumentTermMatrix(corpus.clean.train, control=list(dictionary = fivefreq))
convert_count <- function(x) {
y <- ifelse(x > 0, 1,0)
y <- factor(y, levels=c(0,1), labels=c("No", "Yes"))
y
}
trainNB <- apply(dtm.train.nb, 2, convert_count)
classifier <- naiveBayes(trainNB, df.train$sentiment, laplace = 1)
custom_reviews <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
View(df)
View(df)
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
table("pred"=custom_pred)
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
library(tm)
library(RTextTools)
library(e1071)
library(dplyr)
library(caret)
library(mongolite)
## Get all data from Mongo
con=mongo(collection="reviews",db="movies")
df <-con$find("{}")
df_count <- nrow(df)
## The seed makes the sample function predictable. The results will stay the same
set.seed(1)
## Clean the corpus
clean_corpus <- function(corpus) {
corpus %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(removeWords, stopwords(kind="en")) %>%
tm_map(stripWhitespace)
}
## Randomize all results
df <- df[sample(nrow(df)), ]
df$sentiment <- as.factor(df$sentiment)
corpus <- Corpus(VectorSource(df$text))
corpus.clean <- clean_corpus(corpus)
dtm <- DocumentTermMatrix(corpus.clean)
## Used for the statistics later on
df.train <- df[1:ceiling(df_count / 2),]
df.test <- df[(ceiling(df_count / 2) + 1):df_count,]
dtm.train <- dtm[1:ceiling(df_count / 2),]
dtm.test <- dtm[(ceiling(df_count / 2) + 1):df_count,]
corpus.clean.train <- corpus.clean[1:ceiling(df_count / 2)]
corpus.clean.test <- corpus.clean[(ceiling(df_count / 2) + 1):df_count]
## Custom test set
# doc_id <- c(10000,10001,10002,10003,10004,10005,10006)
# text <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
# sentiment <- c(1, 0, 1, 1, 0, 1, 1)
# sentiment <- as.factor(sentiment)
# df.test <- data.frame(doc_id, text, sentiment)
# test_corpus <- Corpus(VectorSource(df.test$text))
# test_corpus.clean <- test_corpus %>%
#   tm_map(content_transformer(tolower)) %>%
#   tm_map(removePunctuation) %>%
#   tm_map(removeNumbers) %>%
#   tm_map(removeWords, stopwords(kind="en")) %>%
#   tm_map(stripWhitespace)
# dtm.test <- DocumentTermMatrix(test_corpus.clean)
# corpus.clean.test <- test_corpus.clean[]
fivefreq <- findFreqTerms(dtm.train, 5)
dtm.train.nb <- DocumentTermMatrix(corpus.clean.train, control=list(dictionary = fivefreq))
dtm.test.nb <- DocumentTermMatrix(corpus.clean.test, control=list(dictionary = fivefreq))
convert_count <- function(x) {
y <- ifelse(x > 0, 1,0)
y <- factor(y, levels=c(0,1), labels=c("No", "Yes"))
y
}
trainNB <- apply(dtm.train.nb, 2, convert_count)
testNB <- apply(dtm.test.nb, 2, convert_count)
classifier <- naiveBayes(trainNB, df.train$sentiment, laplace = 1)
library(tm)
library(RTextTools)
library(e1071)
library(dplyr)
library(caret)
library(mongolite)
## Get all data from Mongo
con=mongo(collection="reviews",db="movies")
df <-con$find("{}")
df_count <- nrow(df)
## The seed makes the sample function predictable. The results will stay the same
set.seed(1)
## Clean the corpus
clean_corpus <- function(corpus) {
corpus %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(removeWords, stopwords(kind="en")) %>%
tm_map(stripWhitespace)
}
## Randomize all results
df <- df[sample(nrow(df)), ]
df$sentiment <- as.factor(df$sentiment)
corpus <- Corpus(VectorSource(df$text))
corpus.clean <- clean_corpus(corpus)
dtm <- DocumentTermMatrix(corpus.clean)
## Used for the statistics later on
df.train <- df[1:ceiling(df_count / 2),]
df.test <- df[(ceiling(df_count / 2) + 1):df_count,]
dtm.train <- dtm[1:ceiling(df_count / 2),]
dtm.test <- dtm[(ceiling(df_count / 2) + 1):df_count,]
corpus.clean.train <- corpus.clean[1:ceiling(df_count / 2)]
corpus.clean.test <- corpus.clean[(ceiling(df_count / 2) + 1):df_count]
## Custom test set
# doc_id <- c(10000,10001,10002,10003,10004,10005,10006)
# text <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
# sentiment <- c(1, 0, 1, 1, 0, 1, 1)
# sentiment <- as.factor(sentiment)
# df.test <- data.frame(doc_id, text, sentiment)
# test_corpus <- Corpus(VectorSource(df.test$text))
# test_corpus.clean <- test_corpus %>%
#   tm_map(content_transformer(tolower)) %>%
#   tm_map(removePunctuation) %>%
#   tm_map(removeNumbers) %>%
#   tm_map(removeWords, stopwords(kind="en")) %>%
#   tm_map(stripWhitespace)
# dtm.test <- DocumentTermMatrix(test_corpus.clean)
# corpus.clean.test <- test_corpus.clean[]
fivefreq <- findFreqTerms(dtm.train, 5)
dtm.train.nb <- DocumentTermMatrix(corpus.clean.train, control=list(dictionary = fivefreq))
dtm.test.nb <- DocumentTermMatrix(corpus.clean.test, control=list(dictionary = fivefreq))
convert_count <- function(x) {
y <- ifelse(x > 0, 1,0)
y <- factor(y, levels=c(0,1), labels=c("No", "Yes"))
y
}
trainNB <- apply(dtm.train.nb, 2, convert_count)
testNB <- apply(dtm.test.nb, 2, convert_count)
classifier <- naiveBayes(trainNB, df.train$sentiment, laplace = 1)
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an \" international \" version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a \" cleaner . \" she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed \" too explicit . \" i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_reviews <- c("very good", "very bad", "it's ironic that the best films in cinema history are invariably the original director's cut of the film . films such as aliens , the abyss , the wild bunch , blade runner , and terminator 2 are all prime examples of a filmmaker's integrity , later chopped up or mucked with by the studio . the advent of the dvd format has provided a more accessible way to get these original cuts to the public and provide to film freaks like myself the ability to become further enraptured by the extension of such classic films . the dvd release of the original international version of luc besson's 1995 masterpiece the professional , which is known as l ? on around the world , is a prime example of how a good film can become an instant classic as a director's cut . for years , i have heard of an ' international ' version available only in laserdisc format , which has eluded me for years . i even bought a laserdisc player from my uncle don for 100 bucks just to watch certain directors' cuts - including l ? on . but after countless searches in laserdisc stores , i could never find it . until now . the film follows the story of l ? on , played by jean reno , a professional hit man for an italian mob crew run by danny aiello . he lives next door to a ferociously independent 12-year-old girl named mathilda - played by then newcomer natalie portman , whose father is involved in drugs and crooked cops . one day , a crew of the cops - lead by gary oldman in an over-the-top performance - kills her entire family while mathilda is out buying groceries . taking pity on her , l ? on hides her in his apartment when she returns to save her life . mathilda learns of l ? on's hit man profession and decides to follow in l ? on's footsteps as a ' cleaner . ' she then falls in love with him and manages to reawaken emotions within l ? on he has kept locked away as part of his profession . at this point , the differences in the american version and the international version really kick in . the international version contains an additional 24 minutes of footage that pertains directly to the relationship of l ? on and mathilda , footage that american censors deemed ' too explicit . ' i assume that american censors feel that defining character development is too much for american audiences to handle . the best part of this extra footage is that gives better understanding of both mathilda's and l ? on's motivations pertaining to later actions involving oldman and his crew of bad cops . there's even a previously unseen cameo by the great french actor jean-hugues anglade - star of queen margot , besson's la femme nikita , and killing zoe . with these additional scenes replaced , l ? on and matilda's relationship brings you emotionally closer to the film and draws stronger bonds between the characters that were murky in the american version . the most ironic thing about the international version of the film is that with the inclusion of the missing scenes , the film becomes primarily a heavy , emotional drama punctuated with big action scenes at the beginning and the end of the film . the film betters reflects the serious drama of french cinema but is laced with pieces reflecting the brutality of american cinema . my advice to everyone out there is to throw away your copy of the professional , throw down twenty bucks , and pick up this newly restored cinematic masterpiece . director/writer : luc besson producer : luc besson , claude besson starring : jean reno , natalie portman , gary oldman , danny aiello", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_reviews <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_reviews <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
custom_reviews <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_reviews <- data.frame(custom_reviews)
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
custom_reviews <- c("very good", "very bad", "nice", "ingredients : possessed plastic dolls in love , plastic dolls having sex starring : jennifer tilly , voice of brad dourif , katherine heigl , nick stabile , john ritter synopsis : this is the fourth film in the chucky series , which debuted in the late 1980s . basically , chucky is a plastic doll that can walk and talk because it is possessed by the spirit of a slain murderer . in bride of chucky , chucky's longtime girlfriend tiffany ( jennifer tilly ) dies and her spirit inhabits a female plastic doll through voodoo . dolls tiffany and chucky get married and embark on a quest to reach a cemetery in new jersey , where a mystical gem might enable them to be humans . the dolls stow away in the back of a vehicle driven by a newly eloped couple , so in the side plot , the couple suspects each other of being a murderer . opinion : bride of chucky is an attempt at horror with humor , but doesn't succeed . somehow , chucky moaning about mid life crisis , and how he should have gotten married does not make for a very scary chucky . and tiffany harping about mid life crisis , and how she should have gotten married does not make for a very scary tiffany . the suspenseless bride of chucky relies mostly on jennifer tilly's cleavage to keep attention during the first half , and on occasional puns to keep attention during the second half . the best that can be said about bride of chucky is that it is sarcastic .", "hate", "love", "I really like this movie. Awesome")
custom_corpus <- Corpus(VectorSource(custom_reviews))
custom_corpus <- clean_corpus(custom_corpus)
custom_dtm <- DocumentTermMatrix(custom_corpus, control=list(dictionary = fivefreq))
custom_dtm <- apply(custom_dtm, 2, convert_count)
custom_pred <- predict(classifier, newdata=custom_dtm)
custom_pred
table("pred"=custom_pred)
library(tm)
library(RTextTools)
library(e1071)
library(dplyr)
library(caret)
library(mongolite)
## Get all data from Mongo
con=mongo(collection="reviews",db="movies")
df <-con$find("{}")
df_count <- nrow(df)
## The seed makes the sample function predictable. The results will stay the same
set.seed(1)
## Clean the corpus
clean_corpus <- function(corpus) {
corpus %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(removeWords, stopwords(kind="en")) %>%
tm_map(stripWhitespace)
}
## Randomize all results
df <- df[sample(nrow(df)), ]
View(df)
df$sentiment <- as.factor(df$sentiment)
View(df)
View(df)
corpus <- Corpus(VectorSource(df$text))
View(corpus)
View(corpus)
corpus[[1]][1]]
corpus[[1]][1]
View(df)
library(tm)
library(RTextTools)
library(e1071)
library(dplyr)
library(caret)
library(mongolite)
## Get all data from Mongo
con=mongo(collection="reviews",db="movies")
df <-con$find("{}")
df_count <- nrow(df)
## The seed makes the sample function predictable. The results will stay the same
set.seed(1)
## Clean the corpus
clean_corpus <- function(corpus) {
corpus %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(removeWords, stopwords(kind="en")) %>%
tm_map(stripWhitespace)
}
## Randomize all results
df <- df[sample(nrow(df)), ]
corpus <- Corpus(VectorSource(df$text))
corpus.clean <- clean_corpus(corpus)
dtm <- DocumentTermMatrix(corpus.clean)
## Used for the statistics later on
df.train <- df[1:ceiling(df_count / 2),]
df.test <- df[(ceiling(df_count / 2) + 1):df_count,]
dtm.train <- dtm[1:ceiling(df_count / 2),]
dtm.test <- dtm[(ceiling(df_count / 2) + 1):df_count,]
corpus.clean.train <- corpus.clean[1:ceiling(df_count / 2)]
corpus.clean.test <- corpus.clean[(ceiling(df_count / 2) + 1):df_count]
fivefreq <- findFreqTerms(dtm.train, 5)
dtm.train.nb <- DocumentTermMatrix(corpus.clean.train, control=list(dictionary = fivefreq))
dtm.test.nb <- DocumentTermMatrix(corpus.clean.test, control=list(dictionary = fivefreq))
#
# convert_count <- function(x) {
#   y <- ifelse(x > 0, 1,0)
#   y <- factor(y, levels=c(0,1), labels=c("No", "Yes"))
#   y
# }
#
# trainNB <- apply(dtm.train.nb, 2, convert_count)
# testNB <- apply(dtm.test.nb, 2, convert_count)
classifier <- naiveBayes(trainNB, df.train$sentiment, laplace = 1)
pred <- predict(classifier, newdata=testNB)
table("Predictions"= pred,  "Actual" = df.test$sentiment )
conf.mat <- confusionMatrix(pred, df.test$sentiment)
conf.mat
# Load required libraries
library(tm)
library(RTextTools)
library(e1071)
library(dplyr)
library(caret)
library(mongolite)
## Get all data from Mongo
con=mongo(collection="reviews",db="movies")
df <-con$find("{}")
df_count <- nrow(df)
## The seed makes the sample function predictable. The results will stay the same
set.seed(1)
## Clean the corpus
clean_corpus <- function(corpus) {
corpus %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(removeWords, stopwords(kind="en")) %>%
tm_map(stripWhitespace)
}
## Randomize all results
df <- df[sample(nrow(df)), ]
corpus <- Corpus(VectorSource(df$text))
corpus.clean <- clean_corpus(corpus)
dtm <- DocumentTermMatrix(corpus.clean)
## Used for the statistics later on
df.train <- df[1:ceiling(df_count / 2),]
df.test <- df[(ceiling(df_count / 2) + 1):df_count,]
dtm.train <- dtm[1:ceiling(df_count / 2),]
dtm.test <- dtm[(ceiling(df_count / 2) + 1):df_count,]
corpus.clean.train <- corpus.clean[1:ceiling(df_count / 2)]
corpus.clean.test <- corpus.clean[(ceiling(df_count / 2) + 1):df_count]
fivefreq <- findFreqTerms(dtm.train, 5)
dtm.train.nb <- DocumentTermMatrix(corpus.clean.train, control=list(dictionary = fivefreq))
dtm.test.nb <- DocumentTermMatrix(corpus.clean.test, control=list(dictionary = fivefreq))
#
# convert_count <- function(x) {
#   y <- ifelse(x > 0, 1,0)
#   y <- factor(y, levels=c(0,1), labels=c("No", "Yes"))
#   y
# }
#
# trainNB <- apply(dtm.train.nb, 2, convert_count)
# testNB <- apply(dtm.test.nb, 2, convert_count)
classifier <- naiveBayes(trainNB, df.train$sentiment, laplace = 1)
## Get all data from Mongo
con=mongo(collection="reviews",db="movies")
df <-con$find("{}")
df_count <- nrow(df)
## The seed makes the sample function predictable. The results will stay the same
set.seed(1)
## Clean the corpus
clean_corpus <- function(corpus) {
corpus %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(removeWords, stopwords(kind="en")) %>%
tm_map(stripWhitespace)
}
## Randomize all results
df <- df[sample(nrow(df)), ]
corpus <- Corpus(VectorSource(df$text))
corpus.clean <- clean_corpus(corpus)
dtm <- DocumentTermMatrix(corpus.clean)
## Used for the statistics later on
df.train <- df[1:ceiling(df_count / 2),]
df.test <- df[(ceiling(df_count / 2) + 1):df_count,]
dtm.train <- dtm[1:ceiling(df_count / 2),]
dtm.test <- dtm[(ceiling(df_count / 2) + 1):df_count,]
corpus.clean.train <- corpus.clean[1:ceiling(df_count / 2)]
corpus.clean.test <- corpus.clean[(ceiling(df_count / 2) + 1):df_count]
fivefreq <- findFreqTerms(dtm.train, 5)
dtm.train.nb <- DocumentTermMatrix(corpus.clean.train, control=list(dictionary = fivefreq))
dtm.test.nb <- DocumentTermMatrix(corpus.clean.test, control=list(dictionary = fivefreq))
#
# convert_count <- function(x) {
#   y <- ifelse(x > 0, 1,0)
#   y <- factor(y, levels=c(0,1), labels=c("No", "Yes"))
#   y
# }
#
# trainNB <- apply(dtm.train.nb, 2, convert_count)
# testNB <- apply(dtm.test.nb, 2, convert_count)
classifier <- naiveBayes(dtm.train.nb, df.train$sentiment, laplace = 1)
pred <- predict(classifier, newdata=dtm.test.nb)
table("Predictions"= pred,  "Actual" = df.test$sentiment )
conf.mat <- confusionMatrix(pred, df.test$sentiment)
conf.mat
## Get all data from Mongo
con=mongo(collection="reviews",db="movies")
df <-con$find("{}")
df_count <- nrow(df)
## The seed makes the sample function predictable. The results will stay the same
set.seed(1)
## Clean the corpus
clean_corpus <- function(corpus) {
corpus %>%
tm_map(content_transformer(tolower)) %>%
tm_map(removePunctuation) %>%
tm_map(removeNumbers) %>%
tm_map(removeWords, stopwords(kind="en")) %>%
tm_map(stripWhitespace)
}
## Randomize all results
df <- df[sample(nrow(df)), ]
corpus <- Corpus(VectorSource(df$text))
corpus.clean <- clean_corpus(corpus)
dtm <- DocumentTermMatrix(corpus.clean)
## Used for the statistics later on
df.train <- df[1:ceiling(df_count / 2),]
df.test <- df[(ceiling(df_count / 2) + 1):df_count,]
dtm.train <- dtm[1:ceiling(df_count / 2),]
dtm.test <- dtm[(ceiling(df_count / 2) + 1):df_count,]
corpus.clean.train <- corpus.clean[1:ceiling(df_count / 2)]
corpus.clean.test <- corpus.clean[(ceiling(df_count / 2) + 1):df_count]
fivefreq <- findFreqTerms(dtm.train, 5)
dtm.train.nb <- DocumentTermMatrix(corpus.clean.train, control=list(dictionary = fivefreq))
dtm.test.nb <- DocumentTermMatrix(corpus.clean.test, control=list(dictionary = fivefreq))
#
# convert_count <- function(x) {
#   y <- ifelse(x > 0, 1,0)
#   y <- factor(y, levels=c(0,1), labels=c("No", "Yes"))
#   y
# }
#
# trainNB <- apply(dtm.train.nb, 2, convert_count)
# testNB <- apply(dtm.test.nb, 2, convert_count)
classifier <- naiveBayes(dtm.train.nb, df.train$sentiment, laplace = 1)
pred <- predict(classifier, newdata=dtm.test.nb)
table("Predictions"= pred,  "Actual" = df.test$sentiment )
conf.mat <- confusionMatrix(pred, df.test$sentiment)
conf.mat
